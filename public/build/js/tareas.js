!function(){function e(e,r,t){const a=document.querySelector(".alerta");a&&a.remove();const n=document.createElement("DIV");n.classList.add("alerta",r),n.textContent=e,"success"===r&&(n.style.backgroundColor="green"),t.parentElement.insertBefore(n,t.nextElementSibling),setTimeout(()=>{n.remove()},5e3)}document.querySelector("#agregar-tarea").addEventListener("click",(function(){fetch("/obtener-clientes").then(e=>e.json()).then(r=>{const t=`\n                <div class="campo">\n                    <label>Seleccionar Cliente</label>\n                    <select name="cliente" id="cliente" class="seleccion-cliente">\n                        ${r.map(e=>`<option value="${e.id}">${e.nombres} ${e.apellidos}</option>`).join("")}\n                    </select>\n                </div>\n            `,a=document.createElement("DIV");a.classList.add("modal"),a.innerHTML=`\n                <form class="formulario nueva-tarea">\n                    <legend>Añade una nueva tarea</legend>\n                    ${t}\n                    <div class="campo">\n                        <label>Tarea</label>\n                        <input\n                            type="text"\n                            name="tarea"\n                            placeholder="Añadir Tarea al Proyecto Actual"\n                            id="tarea"/>\n                    </div>\n                    <div class="opciones">\n                        <input type="submit" class="submit-nueva-tarea" value="Añadir Tarea"/>\n                        <button type="button" class="cerrar-modal">Cancelar</button>\n                    </div>\n                </form>`,setTimeout(()=>{a.querySelector(".formulario").classList.add("animar"),$(".seleccion-cliente").select2()},0),a.addEventListener("click",(async function(r){if(r.preventDefault(),r.target.classList.contains("cerrar-modal")){a.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{a.remove()},500)}if(r.target.classList.contains("submit-nueva-tarea")){await async function(){const r=document.querySelector("#tarea").value.trim(),t=document.querySelector("#cliente").value;if(!t)return void e("ID de cliente no proporcionado","error",document.querySelector(".formulario legend"));if(""===r)return void e("El nombre de la tarea es obligatorio","error",document.querySelector(".formulario legend"));const a={cliente_id:t,tarea:r};a.usuario_id=1;try{const r=await fetch("/crear-tarea",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),t=await r.json();t.success?e(t.mensaje,"success",document.querySelector(".formulario legend")):e(t.error,"error",document.querySelector(".formulario legend"))}catch(r){console.error("Error al enviar la tarea al servidor:",r),e("Error al enviar la tarea al servidor","error",document.querySelector(".formulario legend"))}}();a.querySelector("#tarea").value=""}})),document.querySelector("body").appendChild(a)}).catch(e=>{console.error("Error al obtener la lista de clientes:",e)})}))}();